import{av as y}from"./DnaJ7Dsa.js";function x(){const{$axios:t}=y();return t}const b=9,I="-nodwl",g="0";var S=(t=>(t.Latest="latest",t.Search="search",t.Yours="yours",t))(S||{}),M=(t=>(t.All="all",t.ModQueue="modQueue",t.Modded="modded",t))(M||{}),k=(t=>(t.Unmodded="unmodded",t.Modded="modded",t.Unknown="unknown",t))(k||{});async function h(t,e,n=!1,o){try{return(await x()({method:"POST",url:t,signal:o,params:e,paramsSerializer:s=>(s.level&&!s.levels&&!n&&(s.levels=s.level,s.level=void 0),new URLSearchParams(s).toString())})).data}catch(a){throw a}}function R(t){return t.totalPlayTime/t.totalPlayTimePeople}function _(t){const e=t.x/255*360,n=t.y/255,o=t.z/255;let a=0,c=0,s=0;const l=Math.floor(e/60),i=e/60-l,r=o*(1-n),d=o*(1-i*n),u=o*(1-(1-i)*n);switch(l%6){case 0:a=o,c=u,s=r;break;case 1:a=d,c=o,s=r;break;case 2:a=r,c=o,s=u;break;case 3:a=r,c=d,s=o;break;case 4:a=u,c=r,s=o;break;case 5:a=o,c=r,s=d;break}return{x:Math.round(a*255),y:Math.round(c*255),z:Math.round(s*255)}}function T(t){let[e,n,o]=[t.x/255,t.y/255,t.z/255],a=Math.max(e,n,o),c=Math.min(e,n,o),s=a,l=a,i=a,r=a-c;if(l=a===0?0:r/a,a===c)s=0;else{switch(a){case e:s=(n-o)/r+(n<o?6:0);break;case n:s=(o-e)/r+2;break;case o:s=(e-n)/r+4;break}s/=6}return{x:s,y:l,z:i}}function f(t,e,n){let o=Math.round(t.x*(1-n)+e.x*n),a=Math.round(t.y*(1-n)+e.y*n),c=Math.round(t.z*(1-n)+e.z*n);return{x:o,y:a,z:c}}function z(t){const e={x:0,y:0,z:0},n={x:128,y:128,z:128},o=_({x:t,y:210,z:255}),a=f(o,n,.3),c=f(a,e,.6),s=f(c,e,.2);return{background:a,main:c,player:s}}function C(t){return z(t.color)}function A(t,e,n){const o=1-n,a=(t.x-e.x*n)/o,c=(t.y-e.y*n)/o,s=(t.z-e.z*n)/o;return{x:Math.max(0,Math.min(255,Math.round(a))),y:Math.max(0,Math.min(255,Math.round(c))),z:Math.max(0,Math.min(255,Math.round(s)))}}function D(t){const n=A(t,{x:128,y:128,z:128},.3),o=T(n);return Math.round(o.x*255)}async function N(t){function e(i){return i.toString(16).padStart(2,"0")}function n(){const i=e(t.color),r=parseInt(i.slice(0,2),16),d=parseInt(i.slice(2,4),16),u=parseInt(i.slice(4,6),16);return D({x:r,y:d,z:u})}const o=`data:image/png;base64,${t.imageURI.slice(7)}`,a=await fetch(o).then(i=>i.blob());let c=0;const s=t.content.indexOf("COLORS");if(s===-1)c=n();else{const i=[];for(let r=s+7;r<t.content.length;r++){const d=t.content[r];if(isNaN(Number(d)))break;i.push(d)}c=parseInt(i.join(""),10)}let l="unknown";return parseInt(t.moderationStatus)===0?l="unmodded":parseInt(t.moderationStatus)===1&&(l="modded"),t!=null&&t.description&&(t!=null&&t.description.includes(I))&&(t.content=""),{id:t.id,name:t.name,description:t.description,walkthroughLink:t.walkthroughLink,creator:t.creator,content:t.content,imageURI:a,creationTime:new Date(t.creationTime),color:c,totalPlayTime:t.totalPlayTime,totalPlayTimePeople:t.totalPlayTimePeople,bestScore:t.bestScore,featured:t.featured,plays:t.plays,starts:t.starts,totalCompletions:t.totalCompletions,stars:t.upvotes,moderationStatus:l,version:t.version,bestScoreLog:t.bestScoreLog,deviceID:t.deviceID,additionalInfo:t.additionalInfo}}async function p(t){if(!t||!t.levels||!Array.isArray(t.levels)||t.levels.length===0)return[];let e=[];for(const n of t.levels)e.push(await N(n));return e}async function O(t,e,n,o,a,c){return await h("GetLevels",{sortMode:t,page:e,itemsPerPage:n,spec:o,query:a,supportsCollections:2,cachedLevels:null,pagingInfo:null,version:b,deviceID:g},!1,c)}async function E(t,e,n,o,a,c){return await p(await O(t,e,n,o,a,c))}async function U(t){const e={levels:t.join(","),deviceID:g},n=await h("GetLevelsById",e);return await p(n)}async function $(t){return await h("GetLevelAdvancedInfo",{level:t,deviceID:g},!0)}function j(t){const e=t/60,n=Math.floor(e/60),o=Math.floor(e%60),a=Math.floor(e%1*100);return`${n}:${o.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}const m="level_metadata";function v(t){const e={id:t.id,bookmarked:!1},n=JSON.parse(localStorage.getItem(m)||"{}");return n&&n.length>0&&n.find(a=>a.id===t.id)||e}function G(t,e){const n=JSON.parse(localStorage.getItem(m)||"[]"),o=n.findIndex(a=>a.id===t.id);o!==-1?n[o]=Object.assign(n[o],e):n.push(e),localStorage.setItem(m,JSON.stringify(n))}function J(){return JSON.parse(localStorage.getItem(m)||"[]")}export{b as L,k as M,I as N,S,U as a,E as b,M as c,$ as d,v as e,C as f,J as g,j as h,R as i,z as j,G as s};
